import{j as e}from"./ui-y-bLX9_f.js";import{u as s,F as r,a,b as t,c as i,d as n,e as o,t as c}from"./form-H9qvde6N.js";import{z as l}from"./utils-Dn-dWpL4.js";import{m as d,v as m,G as u,u as x,a as g,C as h,b as f,c as j,d as p,e as b,f as v,B as N,g as w}from"./index-_Z1qpR2A.js";import{I as y}from"./input-C1cZPFhz.js";import{a as C}from"./vendor-CEJmk-mZ.js";const k=m("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),S=C.forwardRef((({className:s,variant:r,...a},t)=>e.jsx("div",{ref:t,role:"alert",className:d(k({variant:r}),s),...a})));S.displayName="Alert";const P=C.forwardRef((({className:s,...r},a)=>e.jsx("h5",{ref:a,className:d("mb-1 font-medium leading-none tracking-tight",s),...r})));P.displayName="AlertTitle";const A=C.forwardRef((({className:s,...r},a)=>e.jsx("div",{ref:a,className:d("text-sm [&_p]:leading-relaxed",s),...r})));function z(e){return u({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"},child:[]}]})(e)}A.displayName="AlertDescription";const V=l.object({username:l.string().min(3,"Nome de usuário deve ter pelo menos 3 caracteres"),password:l.string().min(6,"Senha deve ter pelo menos 6 caracteres"),confirmPassword:l.string().min(6,"Confirmação de senha deve ter pelo menos 6 caracteres")}).refine((e=>e.password===e.confirmPassword),{message:"As senhas não coincidem",path:["confirmPassword"]});function T(){const[l,d]=C.useState(!1),[m,u]=x(),[k,T]=C.useState(!1),{toast:D}=g(),E=s({resolver:c(V),defaultValues:{username:"",password:"",confirmPassword:""}});return k?e.jsx("div",{className:"flex min-h-screen items-center justify-center bg-black/95 p-4",children:e.jsxs(h,{className:"w-full max-w-md border-green-500/20 bg-black text-white",children:[e.jsxs(f,{className:"space-y-1",children:[e.jsx(j,{className:"text-2xl font-bold text-green-500",children:"Configuração Concluída"}),e.jsx(p,{className:"text-gray-400",children:"Seu usuário administrador foi criado com sucesso!"})]}),e.jsx(b,{children:e.jsxs(S,{className:"border-green-500/30 bg-green-500/10 text-green-200",children:[e.jsx(z,{className:"h-5 w-5"}),e.jsx(P,{children:"Sucesso!"}),e.jsx(A,{children:"Agora você pode fazer login na área administrativa com o usuário que acabou de criar."})]})}),e.jsxs(v,{className:"flex justify-center space-x-4",children:[e.jsx(N,{variant:"default",className:"bg-green-600 hover:bg-green-700 text-white",onClick:()=>u("/login"),children:"Ir para Login"}),e.jsx(N,{variant:"outline",className:"border-green-500/20 text-green-400 hover:bg-green-500/10",onClick:()=>u("/"),children:"Voltar ao Portfólio"})]})]})}):e.jsx("div",{className:"flex min-h-screen items-center justify-center bg-black/95 p-4",children:e.jsxs(h,{className:"w-full max-w-md border-green-500/20 bg-black text-white",children:[e.jsxs(f,{className:"space-y-1",children:[e.jsx(j,{className:"text-2xl font-bold text-green-500",children:"Primeira Configuração"}),e.jsx(p,{className:"text-gray-400",children:"Crie um usuário administrador para gerenciar seu portfólio"})]}),e.jsxs(b,{children:[e.jsxs(S,{className:"mb-4 border-amber-500/30 bg-amber-500/10 text-amber-200",children:[e.jsx(z,{className:"h-5 w-5"}),e.jsx(P,{children:"Configuração inicial"}),e.jsx(A,{children:"Esta é uma página de uso único para criar o primeiro usuário administrador. Após a criação, ela não estará mais disponível."})]}),e.jsx(r,{...E,children:e.jsxs("form",{onSubmit:E.handleSubmit((async function(e){d(!0);try{const{confirmPassword:s,...r}=e,a=await w("/api/auth/setup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(a.ok)D({title:"Configuração concluída",description:"Usuário administrador criado com sucesso!"}),T(!0);else{const e=await a.json();D({variant:"destructive",title:"Erro na configuração",description:e.message||"Falha ao criar usuário administrador."})}}catch(s){D({variant:"destructive",title:"Erro na configuração",description:"Ocorreu um erro ao configurar. Tente novamente."})}finally{d(!1)}})),className:"space-y-4",children:[e.jsx(a,{control:E.control,name:"username",render:({field:s})=>e.jsxs(t,{children:[e.jsx(i,{className:"text-gray-300",children:"Nome de Usuário"}),e.jsx(n,{children:e.jsx(y,{placeholder:"Digite um nome de usuário",className:"border-green-500/20 bg-gray-900 text-white focus-visible:ring-green-500",...s})}),e.jsx(o,{className:"text-red-500"})]})}),e.jsx(a,{control:E.control,name:"password",render:({field:s})=>e.jsxs(t,{children:[e.jsx(i,{className:"text-gray-300",children:"Senha"}),e.jsx(n,{children:e.jsx(y,{type:"password",placeholder:"Digite uma senha segura",className:"border-green-500/20 bg-gray-900 text-white focus-visible:ring-green-500",...s})}),e.jsx(o,{className:"text-red-500"})]})}),e.jsx(a,{control:E.control,name:"confirmPassword",render:({field:s})=>e.jsxs(t,{children:[e.jsx(i,{className:"text-gray-300",children:"Confirmar Senha"}),e.jsx(n,{children:e.jsx(y,{type:"password",placeholder:"Confirme sua senha",className:"border-green-500/20 bg-gray-900 text-white focus-visible:ring-green-500",...s})}),e.jsx(o,{className:"text-red-500"})]})}),e.jsx(N,{type:"submit",disabled:l,className:"w-full bg-green-600 hover:bg-green-700 text-white",children:l?"Configurando...":"Criar Usuário Administrador"})]})})]}),e.jsx(v,{className:"flex justify-center",children:e.jsx(N,{variant:"link",className:"text-green-500 hover:text-green-400",onClick:()=>u("/"),children:"Voltar ao Portfólio"})})]})})}export{T as default};
