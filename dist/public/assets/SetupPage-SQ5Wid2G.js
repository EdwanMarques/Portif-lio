import{r as i,j as e,z as v,M as V,N as E,u as M,a as R,C as w,b as y,c as C,d as S,e as k,f as F,B as c,g as B}from"./index-CfFqY53g.js";import{u as O,F as U,a as m,b as u,c as x,d as g,e as h,t as q,z as l}from"./form-DHJoqhK_.js";import{I as f}from"./input-CeJG5A7o.js";const H=V("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),p=i.forwardRef(({className:r,variant:s,...t},o)=>e.jsx("div",{ref:o,role:"alert",className:v(H({variant:s}),r),...t}));p.displayName="Alert";const j=i.forwardRef(({className:r,...s},t)=>e.jsx("h5",{ref:t,className:v("mb-1 font-medium leading-none tracking-tight",r),...s}));j.displayName="AlertTitle";const b=i.forwardRef(({className:r,...s},t)=>e.jsx("div",{ref:t,className:v("text-sm [&_p]:leading-relaxed",r),...s}));b.displayName="AlertDescription";function P(r){return E({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"},child:[]}]})(r)}const _=l.object({username:l.string().min(3,"Nome de usuário deve ter pelo menos 3 caracteres"),password:l.string().min(6,"Senha deve ter pelo menos 6 caracteres"),confirmPassword:l.string().min(6,"Confirmação de senha deve ter pelo menos 6 caracteres")}).refine(r=>r.password===r.confirmPassword,{message:"As senhas não coincidem",path:["confirmPassword"]});function Q(){const[r,s]=i.useState(!1),[t,o]=M(),[A,z]=i.useState(!1),{toast:d}=R(),n=O({resolver:q(_),defaultValues:{username:"",password:"",confirmPassword:""}});async function D(a){s(!0);try{const{confirmPassword:I,...T}=a,N=await B("/api/auth/setup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(T)});if(N.ok)d({title:"Configuração concluída",description:"Usuário administrador criado com sucesso!"}),z(!0);else{const L=await N.json();d({variant:"destructive",title:"Erro na configuração",description:L.message||"Falha ao criar usuário administrador."})}}catch{d({variant:"destructive",title:"Erro na configuração",description:"Ocorreu um erro ao configurar. Tente novamente."})}finally{s(!1)}}return A?e.jsx("div",{className:"flex min-h-screen items-center justify-center bg-black/95 p-4",children:e.jsxs(w,{className:"w-full max-w-md border-green-500/20 bg-black text-white",children:[e.jsxs(y,{className:"space-y-1",children:[e.jsx(C,{className:"text-2xl font-bold text-green-500",children:"Configuração Concluída"}),e.jsx(S,{className:"text-gray-400",children:"Seu usuário administrador foi criado com sucesso!"})]}),e.jsx(k,{children:e.jsxs(p,{className:"border-green-500/30 bg-green-500/10 text-green-200",children:[e.jsx(P,{className:"h-5 w-5"}),e.jsx(j,{children:"Sucesso!"}),e.jsx(b,{children:"Agora você pode fazer login na área administrativa com o usuário que acabou de criar."})]})}),e.jsxs(F,{className:"flex justify-center space-x-4",children:[e.jsx(c,{variant:"default",className:"bg-green-600 hover:bg-green-700 text-white",onClick:()=>o("/login"),children:"Ir para Login"}),e.jsx(c,{variant:"outline",className:"border-green-500/20 text-green-400 hover:bg-green-500/10",onClick:()=>o("/"),children:"Voltar ao Portfólio"})]})]})}):e.jsx("div",{className:"flex min-h-screen items-center justify-center bg-black/95 p-4",children:e.jsxs(w,{className:"w-full max-w-md border-green-500/20 bg-black text-white",children:[e.jsxs(y,{className:"space-y-1",children:[e.jsx(C,{className:"text-2xl font-bold text-green-500",children:"Primeira Configuração"}),e.jsx(S,{className:"text-gray-400",children:"Crie um usuário administrador para gerenciar seu portfólio"})]}),e.jsxs(k,{children:[e.jsxs(p,{className:"mb-4 border-amber-500/30 bg-amber-500/10 text-amber-200",children:[e.jsx(P,{className:"h-5 w-5"}),e.jsx(j,{children:"Configuração inicial"}),e.jsx(b,{children:"Esta é uma página de uso único para criar o primeiro usuário administrador. Após a criação, ela não estará mais disponível."})]}),e.jsx(U,{...n,children:e.jsxs("form",{onSubmit:n.handleSubmit(D),className:"space-y-4",children:[e.jsx(m,{control:n.control,name:"username",render:({field:a})=>e.jsxs(u,{children:[e.jsx(x,{className:"text-gray-300",children:"Nome de Usuário"}),e.jsx(g,{children:e.jsx(f,{placeholder:"Digite um nome de usuário",className:"border-green-500/20 bg-gray-900 text-white focus-visible:ring-green-500",...a})}),e.jsx(h,{className:"text-red-500"})]})}),e.jsx(m,{control:n.control,name:"password",render:({field:a})=>e.jsxs(u,{children:[e.jsx(x,{className:"text-gray-300",children:"Senha"}),e.jsx(g,{children:e.jsx(f,{type:"password",placeholder:"Digite uma senha segura",className:"border-green-500/20 bg-gray-900 text-white focus-visible:ring-green-500",...a})}),e.jsx(h,{className:"text-red-500"})]})}),e.jsx(m,{control:n.control,name:"confirmPassword",render:({field:a})=>e.jsxs(u,{children:[e.jsx(x,{className:"text-gray-300",children:"Confirmar Senha"}),e.jsx(g,{children:e.jsx(f,{type:"password",placeholder:"Confirme sua senha",className:"border-green-500/20 bg-gray-900 text-white focus-visible:ring-green-500",...a})}),e.jsx(h,{className:"text-red-500"})]})}),e.jsx(c,{type:"submit",disabled:r,className:"w-full bg-green-600 hover:bg-green-700 text-white",children:r?"Configurando...":"Criar Usuário Administrador"})]})})]}),e.jsx(F,{className:"flex justify-center",children:e.jsx(c,{variant:"link",className:"text-green-500 hover:text-green-400",onClick:()=>o("/"),children:"Voltar ao Portfólio"})})]})})}export{Q as default};
